diff --git a/epan/dissectors/packet-sdp.c b/epan/dissectors/packet-sdp.c
index
--- trunk/epan/dissectors/packet-sdp.c	2012/12/03 11:39:22	46343
+++ trunk/epan/dissectors/packet-sdp.c	2012/12/03 13:55:03	46344
@@ -1839,6 +1839,10 @@
       /* We are at the first colon */
       /* tag */
       next_offset = tvb_find_guint8(tvb, offset, -1, ' ');
+	  if(next_offset==-1){
+		  /* XXX Add expert item? */
+		  return;
+	  }
       tokenlen    = next_offset - offset;
       proto_tree_add_uint(sdp_media_attribute_tree, hf_sdp_crypto_tag, tvb, offset, tokenlen,
           atoi((char*)tvb_get_ephemeral_string(tvb, offset, tokenlen)));
@@ -1846,6 +1850,10 @@
 
       /* crypto-suite */
       next_offset = tvb_find_guint8(tvb, offset, -1, ' ');
+	  if(next_offset==-1){
+		  /* XXX Add expert item? */
+		  return;
+	  }
       tokenlen    = next_offset - offset;
       proto_tree_add_item(sdp_media_attribute_tree, hf_sdp_crypto_crypto_suite,
           tvb, offset, tokenlen, ENC_ASCII|ENC_NA);
@@ -1894,10 +1902,6 @@
               has_more_pars = FALSE;
               param_end_offset = tvb_length(tvb);
           }
-          parameter_item = proto_tree_add_text(sdp_media_attribute_tree,
-              tvb, offset, param_end_offset-offset, "Key parameters");
-          parameter_tree = proto_item_add_subtree(parameter_item, ett_sdp_crypto_key_parameters);
-
           /* key-method or key-method-ext */
           next_offset = tvb_find_guint8(tvb, offset, -1, ':');
           if (next_offset == -1) {
@@ -1905,7 +1909,11 @@
                   "Invalid key-param (no ':' delimiter)");
               break;
           }
+
           if (tvb_strncaseeql(tvb, offset, "inline", next_offset-offset) == 0) {
+			  parameter_item = proto_tree_add_text(sdp_media_attribute_tree,
+				  tvb, offset, param_end_offset-offset, "Key parameters");
+			  parameter_tree = proto_item_add_subtree(parameter_item, ett_sdp_crypto_key_parameters);
               /* XXX only for SRTP? */
               /* srtp-key-info       = key-salt ["|" lifetime] ["|" mki] */
               offset      = next_offset +1;
@@ -1971,10 +1979,7 @@
               }
               offset = param_end_offset;
           } else {
-              tokenlen = param_end_offset -  next_offset + 1;
-              proto_tree_add_text(parameter_tree, tvb, next_offset + 1, tokenlen,
-                  "%s", tvb_get_ephemeral_string(tvb, next_offset + 1, tokenlen));
-              offset = param_end_offset;
+			  break;
           }
       }