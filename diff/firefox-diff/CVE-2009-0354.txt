diff --git a/js/src/jsobj.cpp b/js/src/jsobj.cpp
--- a/js/src/jsobj.cpp
+++ b/js/src/jsobj.cpp
@@ -1254,17 +1254,17 @@ obj_eval(JSContext *cx, JSObject *obj, u
             }
             OBJ_TO_INNER_OBJECT(cx, obj);
             if (!obj) {
                 ok = JS_FALSE;
                 goto out;
             }
             if (obj != callerScopeChain) {
                 ok = js_CheckPrincipalsAccess(cx, obj,
-                                              caller->script->principals,
+                                              JS_StackFramePrincipals(cx, caller),
                                               cx->runtime->atomState.evalAtom);
                 if (!ok)
                     goto out;
 
                 scopeobj = js_NewWithObject(cx, obj, callerScopeChain, -1);
                 if (!scopeobj) {
                     ok = JS_FALSE;
                     goto out;
