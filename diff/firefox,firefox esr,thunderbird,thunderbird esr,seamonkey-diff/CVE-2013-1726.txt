diff --git a/modules/libmar/src/mar_read.c b/modules/libmar/src/mar_read.c
--- a/modules/libmar/src/mar_read.c
+++ b/modules/libmar/src/mar_read.c
@@ -173,17 +173,17 @@ MarFile *mar_open(const char *path) {
 
   return mar_fpopen(fp);
 }
 
 #ifdef XP_WIN
 MarFile *mar_wopen(const wchar_t *path) {
   FILE *fp;
 
-  fp = _wfopen(path, L"rb");
+  _wfopen_s(&fp, path, L"rb");
   if (!fp)
     return NULL;
 
   return mar_fpopen(fp);
 }
 #endif
 
 void mar_close(MarFile *mar) {
@@ -381,17 +381,17 @@ read_product_info_block(char *path,
  *
  * @param infoBlock Out parameter for where to store the result to
  * @return 0 on success, -1 on failure
 */
 int
 mar_read_product_info_block(MarFile *mar, 
                             struct ProductInformationBlock *infoBlock)
 {
-  int i, hasAdditionalBlocks, offset, 
+  int i, hasAdditionalBlocks,
     offsetAdditionalBlocks, numAdditionalBlocks,
     additionalBlockSize, additionalBlockID;
   /* The buffer size is 97 bytes because the MAR channel name < 64 bytes, and 
      product version < 32 bytes + 3 NULL terminator bytes. */
   char buf[97] = { '\0' };
   int ret = get_mar_file_info_fp(mar->fp, NULL, NULL,
                                  &hasAdditionalBlocks, 
                                  &offsetAdditionalBlocks, 
